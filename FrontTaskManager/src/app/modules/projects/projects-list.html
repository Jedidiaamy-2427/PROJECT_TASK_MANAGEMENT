<div class="p-4 max-w-7xl mx-auto">
  <div class="flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between mb-6">
    <h2 class="text-xl sm:text-2xl font-bold">Projets ({{ projectCount() }})</h2>
    <button class="btn btn-primary w-full sm:w-auto flex" (click)="create()">
      <img src="/assets/icon/add-category.svg" alt="Éditer" class="h-4 w-4 mt-1 mr-2" />
      Nouveau Projet
    </button>
  </div>

  <!-- Loading State -->
  <div *ngIf="isLoading()" class="grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-5">
    <div *ngFor="let i of [1, 2, 3]" class="rounded-2xl border border-gray-300 bg-white/5 p-5 animate-pulse">
      <div class="h-6 bg-gray-600 rounded w-3/4 mb-4"></div>
      <div class="h-4 bg-gray-700 rounded w-full mb-2"></div>
      <div class="h-4 bg-gray-700 rounded w-5/6"></div>
      <div class="flex items-center justify-between mt-4 pt-2">
        <div class="h-3 bg-gray-700 rounded w-1/4"></div>
        <div class="h-8 bg-gray-600 rounded w-1/3"></div>
      </div>
    </div>
  </div>

  <!-- Content -->
  <div *ngIf="!isLoading()">
    <!-- Empty State -->
    <div *ngIf="projects().length === 0" class="text-center py-10 px-4 border-2 border-dashed border-gray-600 rounded-lg">
      <svg class="mx-auto h-12 w-12 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
        <path vector-effect="non-scaling-stroke" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 13h6m-3-3v6m-9 1V7a2 2 0 012-2h6l2 2h6a2 2 0 012 2v8a2 2 0 01-2 2H5a2 2 0 01-2-2z" />
      </svg>
      <h3 class="mt-2 text-lg font-medium text-white">Aucun projet</h3>
      <p class="mt-1 text-sm text-gray-400">Commencez par créer votre premier projet.</p>
      <div class="mt-6">
        <button (click)="create()" type="button" class="btn btn-primary inline-flex items-center">
          <img src="/assets/icon/add-category.svg" alt="" class="h-4 w-4 -ml-1 mr-2" />
          Nouveau Projet
        </button>
      </div>
    </div>

    <!-- Projects List -->
    <ul *ngIf="projects().length > 0" class="grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-5">
      <li *ngFor="let p of projects()"
          class="rounded-2xl border border-gray-300 bg-white/5 backdrop-blur card transition-transform duration-200 hover:-translate-y-0.5 hover:shadow-xl">
        <div class="p-5 flex flex-col gap-3">
          <!-- Header -->
          <div class="flex items-start justify-between gap-3">
            <div class="min-w-0">
              <div class="text-base font-semibold truncate">{{ p.name }}</div>
              <div class="mt-1 text-xs inline-flex items-center gap-2 text-white/70">
                <span class="inline-flex items-center gap-1 rounded-full bg-green-500/15 text-green-500 px-2 py-0.5 text-[11px]">
                  {{ getProjectTasks(p.id) }}
                </span>
              </div>
            </div>
            <div class="shrink-0 flex gap-2">
              <button (click)="edit(p.id)" class="btn btn-primary px-3 py-1.5 text-sm" aria-label="Éditer le projet"> 
                <img src="/assets/icon/Edit_white.svg" alt="" class="h-4 w-3" />
              </button>
              <button (click)="remove(p.id)" class=" btn-danger px-2" title="Supprimer" aria-label="Supprimer le projet">
                <img src="/assets/icon/Delete Vector White.svg" alt="" class="h-5 w-4" />
              </button>
            </div>
          </div>

          <!-- Body -->
          <p class="text-sm leading-relaxed text-gray-500/80 break-words min-h-[2.5rem]">{{ p.description }}</p>

          <!-- Footer -->
          <div class="flex items-center justify-between pt-2">
            <div class="text-[11px] text-white/50">ID : {{ p.id }}</div>
            <button (click)="editTask(p.id)" class="btn btn-primary px-3 py-1.5 text-sm flex" [disabled]="!enableBtnTask(p.id)"> 
              <img src="/assets/icon/Pages Vector Icon.svg" alt="" class="h-5 w-4  mr-2" />
              Gérer les tâches
            </button>
          </div>
        </div>
      </li>
    </ul>
  </div>
</div>


<div *ngIf="projectService.isOpen()" class="fixed inset-0 bg-black/50 flex items-center justify-center p-4">
  <div class="bg-white rounded-lg shadow-lg w-full max-w-lg p-6">
      <app-project-form [id]="projectService.ProjectID()" [isEdit]="projectService.isEdit()"></app-project-form>
    </div>
  </div>